(function(){"use strict";var e={9339:function(e,t,a){var s=a(9963),o=a(6252),i=a(3577);const n={key:0,id:"auth"};function r(e,t,a,s,r,l){const c=(0,o.up)("router-view"),d=(0,o.up)("HeaderFilm"),h=(0,o.up)("TrendMain"),u=(0,o.up)("FooterMain"),m=(0,o.up)("ModalMain");return(0,o.wg)(),(0,o.iD)("div",null,[r.path.includes("Auth")?((0,o.wg)(),(0,o.iD)("div",n,[(0,o.Wm)(c)])):((0,o.wg)(),(0,o.iD)("div",{key:1,id:"app",class:(0,i.C_)({modal:r.stateModal}),style:(0,i.j5)({top:r.stateModal&&-r.locate+"px",right:r.scrollWidth+"px"})},[(0,o.Wm)(d,{onOnChekfind:l.onChekfind,class:(0,i.C_)({spec:r.stateModal}),style:(0,i.j5)({paddingRight:r.scrollWidth+"px"}),path:r.path,show:r.show},null,8,["onOnChekfind","class","style","path","show"]),(0,o._)("main",null,[(0,o.Wm)(c,{modalstate:r.stateModal,path:r.path,switcher:r.check,onGetFindId:l.getFindId},null,8,["modalstate","path","switcher","onGetFindId"]),"Home"===r.path?((0,o.wg)(),(0,o.j4)(h,{key:0,path:r.path,switcher:r.check,onGetFindId:l.getFindId},null,8,["path","switcher","onGetFindId"])):(0,o.kq)("",!0)]),(0,o.Wm)(u,{class:(0,i.C_)({spec:r.stateModal}),style:(0,i.j5)({paddingRight:r.scrollWidth+"px"})},null,8,["class","style"]),((0,o.wg)(),(0,o.j4)(o.lR,{to:"#modalMain"},[(0,o.Wm)(m,{filmsid:r.filmsid,ref:"open",onModalstate:l.modalstate},null,8,["filmsid","onModalstate"])]))],6))])}a(2801);var l=a.p+"img/sprite.a116df51.svg";const c=e=>((0,o.dD)("data-v-c6a1af34"),e=e(),(0,o.Cn)(),e),d=l+"#icon-exit",h=l+"#icon-logo",u=l+"#icon-yes",m=l+"#icon-search",p={class:"header header__home"},g=c((()=>(0,o._)("span",null,"Authorization",-1))),f=["data-name"],_=c((()=>(0,o._)("svg",{class:"subscribe-form__icon rotate-vert-center",width:"32",height:"32"},[(0,o._)("use",{href:d})],-1))),w=[_],v={class:"navigation"},y=c((()=>(0,o._)("svg",{class:"subscribe-form__icon rotate-vert-center",width:"24",height:"24"},[(0,o._)("use",{href:h})],-1))),k=c((()=>(0,o._)("span",{class:"logo-text tracking-in-expand"},[(0,o._)("abbr",{title:"Go to page main",role:"contentinfo"},"Filmoteka")],-1))),b={class:"nav-list"},P={class:"nav-item"},I={class:"nav-item","data-auth":"false"},S=c((()=>(0,o._)("div",{class:"auth-chek"},[(0,o._)("svg",{width:"32px",height:"32px"},[(0,o._)("use",{href:u})])],-1))),F={key:0,action:"",class:"search-form js-form"},M=c((()=>(0,o._)("svg",{class:"menu__icon",width:"12",height:"12"},[(0,o._)("use",{href:m})],-1))),A=[M],C={key:1,class:"library__btn--wrapper"};function E(e,t,a,n,r,l){const c=(0,o.up)("router-link"),d=(0,o.up)("CustomInput"),h=(0,o.up)("ModalBtn"),u=(0,o.up)("CustomSelected"),m=(0,o.up)("ContainerMain");return(0,o.wg)(),(0,o.iD)("header",p,[a.show?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[!a.path.includes("Biblioteka")&&l.checkExpired?((0,o.wg)(),(0,o.j4)(c,{key:0,to:{path:"auth/login"},class:"custom-btn btn-A"},{default:(0,o.w5)((()=>[g])),_:1})):(0,o.kq)("",!0),a.path.includes("Biblioteka")||l.checkExpired?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("button",{key:1,class:"btn__logout","data-name":l.getName(),onClick:t[0]||(t[0]=(0,s.iM)(((...e)=>l.funcLogOut&&l.funcLogOut(...e)),["prevent"]))},w,8,f))],64)):(0,o.kq)("",!0),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o._)("nav",v,[(0,o.Wm)(c,{to:{name:"Home"},onClick:l.toMainPage,class:"logo-link"},{default:(0,o.w5)((()=>[y,k])),_:1},8,["onClick"]),(0,o._)("ul",b,[(0,o._)("li",P,[(0,o.Wm)(c,{to:{name:"Home"},rel:"noopener noreferrer","data-lang":"home",class:"nav-btn home__btn"},{default:(0,o.w5)((()=>[(0,o.Uk)(" home ")])),_:1})]),(0,o._)("li",I,[(0,o.Wm)(c,{class:(0,i.C_)([{active__page:a.path.includes("Biblioteka")},"nav-btn library__btn js-auth"]),to:{name:l.checkExpired?"AuthLogin":"BibliotekaWatched"},rel:"noopener noreferrer","data-lang":"library"},{default:(0,o.w5)((()=>[(0,o.Uk)(" my library ")])),_:1},8,["class","to"]),S])])]),a.path.includes("Biblioteka")?((0,o.wg)(),(0,o.iD)("ul",C,[(0,o._)("li",null,[(0,o.Wm)(h,{name:"WATCHED"})]),(0,o._)("li",null,[(0,o.Wm)(h,{name:"QUEUE"})])])):((0,o.wg)(),(0,o.iD)("form",F,[(0,o.Wm)(d,{find:r.nameFilms,"onUpdate:find":t[1]||(t[1]=e=>r.nameFilms=e),findModifiers:{trim:!0},"data-lang":"placeholder",name:"searchQuery",placeholder:"Movie search",type:"text",class:"input-form"},null,8,["find"]),(0,o._)("button",{class:"submit-btn",type:"submit","aria-label":"search button",onClick:t[2]||(t[2]=(0,s.iM)(((...e)=>l.searchFilms&&l.searchFilms(...e)),["prevent"]))},A)])),(0,o.Wm)(u)])),_:1})])}a(7658);const $={class:"container"};function D(e,t,a,s,i,n){return(0,o.wg)(),(0,o.iD)("div",$,[(0,o.WI)(e.$slots,"default",{},void 0,!0)])}var x={name:"ContainerMain"},U=a(3744);const B=(0,U.Z)(x,[["render",D],["__scopeId","data-v-ead4e680"]]);var W=B;const O=["value"];function L(e,t,a,s,i,n){return(0,o.wg)(),(0,o.iD)("input",{value:a.find,onInput:t[0]||(t[0]=t=>e.$emit("update:find",t.target.value))},null,40,O)}var N={props:["find"],emits:["update:find"]};const R=(0,U.Z)(N,[["render",L],["__scopeId","data-v-12bc3688"]]);var V=R;const T={class:"select__container"},q=["data-lang","value"],Q=["onClick","data-lang","value"];function J(e,t,a,n,r,l){return(0,o.wg)(),(0,o.iD)("div",T,[(0,o.wy)((0,o._)("select",{class:(0,i.C_)(["select__leng",r.show&&"--border__change"]),"onUpdate:modelValue":t[0]||(t[0]=e=>r.selected=e),onMousedown:t[1]||(t[1]=(0,s.iM)(((...e)=>l.funcShowOption&&l.funcShowOption(...e)),["prevent"]))},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.options,(e=>((0,o.wg)(),(0,o.iD)("option",{"data-lang":e.text,value:e.value,key:e.text},(0,i.zw)(e.text),9,q)))),128))],34),[[s.bM,r.selected]]),(0,o.Wm)(s.W3,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.options,(e=>(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",{onClick:t=>l.chooseOption(e.value),class:(0,i.C_)(["option__hover",e.value===r.selected&&"none__selected"]),"data-lang":e.text,value:e.value,key:e.text},null,10,Q)),[[s.F8,r.show]]))),128))])),_:1})])}var j={data(){return{selected:"English",options:[{text:"en",value:"English"},{text:"ua",value:"Ukrainian"},{text:"fi",value:"Finish"}],show:!1}},methods:{funcShowOption(){this.show=!this.show},chooseOption(e){this.selected=e,this.show=!this.show}},watch:{selected(){console.log(this.selected)}}};const z=(0,U.Z)(j,[["render",J],["__scopeId","data-v-217a4ea6"]]);var H=z;function G(e,t,a,s,n,r){const l=(0,o.up)("router-link");return(0,o.wg)(),(0,o.j4)(l,{to:{path:a.name},textcontent:a.name,class:"library__header--btn",onClick:r.toggle},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(a.name),1)])),_:1},8,["to","textcontent","onClick"])}var K={name:"ModalBtn",props:{name:{type:String,requried:!0}},data(){return{}},created(){},methods:{toggle(){this.$router.push({path:this.name.toLowerCase()})}}};const Y=(0,U.Z)(K,[["render",G],["__scopeId","data-v-c74f1a08"]]);var Z=Y,X=a(6784),ee={name:"HeaderMain",components:{ContainerMain:W,CustomInput:V,ModalBtn:Z,CustomSelected:H},props:{path:{type:String,required:!0},show:{type:Boolean,required:!0}},emits:{onChekfind:e=>"boolean"===typeof e},data(){return{switcher:!1,nameFilms:""}},created(){},methods:{searchFilms(){const e=this.nameFilms===JSON.parse(window.localStorage.getItem("findedFilms"));if(!this.nameFilms||e)return e?X.Notify.failure(`You already have movies on request: ${this.nameFilms}`):X.Notify.failure("Search string must have at least one character");this.changeStorage(),this.switcher=!this.switcher,this.$emit("onChekfind",this.switcher)},toMainPage(){window.localStorage.removeItem("numberPage"),window.localStorage.removeItem("findedFilms"),"/"!==this.$route.fullPath?this.$router.push({path:"/"}):this.$router.go(0)},changeStorage(){window.localStorage.removeItem("numberPage"),window.localStorage.removeItem("filmsPage"),window.localStorage.setItem("findedFilms",JSON.stringify(this.nameFilms)),this.nameFilms=""},async funcLogOut(){try{await this.$store.dispatch("LogOut",this.$store.state.token),this.$cookies.remove("token")}catch(e){return console.log(e),e.response?X.Report.failure(`Error ${e.response.data.code}`,e.response.data.message):X.Report.failure(`Error ${e.code}`,e.message)}},getName(){return window.localStorage.getItem("name")}},computed:{checkExpired(){const e=this.$store.state.token;if(!e)return!0;const{exp:t}=JSON.parse(window?.atob(e?.split(".")[1]));return Math.floor(new Date/1e3)>t}}};const te=(0,U.Z)(ee,[["render",E],["__scopeId","data-v-c6a1af34"]]);var ae=te;const se=e=>((0,o.dD)("data-v-03d47a93"),e=e(),(0,o.Cn)(),e),oe=l+"#icon-hearts",ie={class:"footer"},ne={class:"footer-block"},re=se((()=>(0,o._)("li",{class:"footer__items"},[(0,o._)("span",null,"©")],-1))),le={class:"footer__items"},ce=se((()=>(0,o._)("li",{class:"footer__items"},[(0,o._)("p",null,"All Rights Reserved")],-1))),de=se((()=>(0,o._)("li",{class:"footer__items"},[(0,o._)("p",null,"Developed with")],-1))),he=se((()=>(0,o._)("li",{class:"footer__items"},[(0,o._)("svg",{class:"footer__haert"},[(0,o._)("use",{href:oe})])],-1))),ue=se((()=>(0,o._)("li",{class:"footer__items"},[(0,o._)("a",{class:"footer__items--ref"},"by Voitovych")],-1)));function me(e,t,a,s,n,r){return(0,o.wg)(),(0,o.iD)("footer",ie,[(0,o._)("ul",ne,[re,(0,o._)("li",le,[(0,o._)("span",null,(0,i.zw)(r.year()),1)]),ce,de,he,ue])])}var pe={name:"FooterMain",methods:{year(){return(new Date).getFullYear()}}};const ge=(0,U.Z)(pe,[["render",me],["__scopeId","data-v-03d47a93"]]);var fe=ge;const _e=e=>((0,o.dD)("data-v-23952fa9"),e=e(),(0,o.Cn)(),e),we=_e((()=>(0,o._)("div",{class:"gallery__item",style:{display:"none"}},null,-1))),ve={class:"container gallery section"},ye={key:0,class:"pagination-wrap"},ke={class:"gallery-js gallery__list"},be=["onClick"],Pe=["src","alt"],Ie={class:"gallery__info"},Se={class:"gallery__title them"},Fe={class:"gallery__text them"},Me={class:"gallery__rating them"},Ae={key:1,class:"pagination-wrap"};function Ce(e,t,s,n,r,l){const c=(0,o.up)("PaginationHardVue"),d=(0,o.up)("ContainerMain");return(0,o.wg)(),(0,o.iD)("div",null,[we,(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o._)("section",ve,[r.trend?.length&&r.max>1?((0,o.wg)(),(0,o.iD)("div",ye,[(0,o.Wm)(c,{onNumPage:l.setPage,proppages:r.max,ref:"upBtn",path:s.path},null,8,["onNumPage","proppages","path"])])):(0,o.kq)("",!0),(0,o._)("ul",ke,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.trend,(({id:e,title:t,release_date:s,poster_path:n,genre_ids:r,vote_average:c,genres:d})=>((0,o.wg)(),(0,o.iD)("li",{key:e,class:"gallery__item",onClick:t=>l.getIdForModal(e)},[(0,o._)("img",{class:"gallery__img",loading:"lazy",src:n?l.getPoster(n):a(6325),alt:t},null,8,Pe),(0,o._)("div",Ie,[(0,o._)("p",Se,(0,i.zw)(t),1),(0,o._)("p",Fe,[(0,o._)("span",{class:(0,i.C_)({space:l.getGenre(r??d.map((e=>e.id)))?.length>27})},(0,i.zw)(l.getGenre(r??d.map((e=>e.id))))+" | ",3),(0,o.Uk)(" "+(0,i.zw)(l.year(s)),1),(0,o._)("span",Me,(0,i.zw)(c?.toFixed(1)),1)])])],8,be)))),128))]),r.trend?.length&&r.max>1?((0,o.wg)(),(0,o.iD)("div",Ae,[(0,o.Wm)(c,{onNumPage:l.setPage,proppages:r.max,ref:"downBtn",path:s.path},null,8,["onNumPage","proppages","path"])])):(0,o.kq)("",!0)])])),_:1})])}var Ee=a(9669),$e=a.n(Ee),De=a(897),xe=a(842);const Ue=new xe.Z({ttl:6e5,max:100,ttlAutopurge:!0}),Be=$e().create({baseURL:"https://api.themoviedb.org",headers:{"Cache-Control":"no-cache"},adapter:(0,De.Z)($e().defaults.adapter,{defaultCache:Ue})}),We={loader:Be};var Oe=Be;const{VUE_APP_FILMOTEKA:Le}={NODE_ENV:"production",VUE_APP_API_KEY:"AIzaSyCYsVgBiD5Bug4EbXs8CwOEN95dfeXKcO4",VUE_APP_APP_ID:"1:210453152874:web:42c0624495b4605677b613",VUE_APP_AUTH_DOMAIN:"filmotekauth.firebaseapp.com",VUE_APP_FILMOTEKA:"https://filmotekabackend.cyclic.app/api",VUE_APP_MESSAGING_SENDER_ID:"210453152874",VUE_APP_PROJECT_ID:"filmotekauth",VUE_APP_STORAGE_BUCKET:"filmotekauth.appspot.com",BASE_URL:"/"},Ne=$e().create({baseURL:Le,headers:{"Cache-Control":"no-cache"}});class Re{constructor(){this.searchQuery="",this.pageCounter=1,this.API_KEY="a1157fee69973f579feaed0c038c358a",this.movieId=null,this.maxPages=null,this.isLoadGenres=!0}async fetchTopMovies(e,t){const a=`/3/trending/movie/week?api_key=${this.API_KEY}&page=${e}`;try{const e=await Oe.get(a);return this.maxPages=e.data.total_pages,e.data.results}catch(s){return t(),console.log(s)}}async getGenresList(){const e=`/3/genre/movie/list?api_key=${this.API_KEY}`;try{const t=await Oe.get(e);return window.localStorage.setItem("genres",JSON.stringify(t.data.genres)),t.data.genres}catch(t){return t}}async fetchMovieById(e){const t=`/3/movie/${e}?api_key=${this.API_KEY}`;try{const e=await Oe.get(t);return e.data}catch(a){return a}}async fetchMovieByQuery(e,t,a){console.log("test");const s=`/3/search/movie?api_key=${this.API_KEY}&page=${e}&query=${t.replaceAll('"',"")}`;try{const e=await Oe.get(s);return this.maxPages=e.data.total_pages,e.data.results}catch(o){return a(),o}}get id(){return this.movieId}get page(){return this.pageCounter}set page(e){this.pageCounter=e}get query(){return this.searchQuery}}const Ve=["proppages"],Te={class:"pagination__list"};function qe(e,t,a,n,r,l){return(0,o.wg)(),(0,o.iD)("div",{class:"pagination",proppages:a.proppages},[r.page>1?((0,o.wg)(),(0,o.iD)("button",{key:0,class:"arrow pagination__button",type:"button",onClick:t[0]||(t[0]=(0,s.iM)(((...e)=>l.pageMinus&&l.pageMinus(...e)),["stop"]))}," ‹ ")):(0,o.kq)("",!0),(0,o._)("ul",Te,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.arrPage,((e,a)=>((0,o.wg)(),(0,o.iD)("li",{key:a},[(0,o._)("button",{onClick:t[1]||(t[1]=(0,s.iM)(((...e)=>l.setPage&&l.setPage(...e)),["stop"])),ref_for:!0,ref:"point",class:(0,i.C_)(["pagination__button",{active:+e===r.page}])},(0,i.zw)(e),3)])))),128))]),r.page!==r.serverDate.at(-1)?((0,o.wg)(),(0,o.iD)("button",{key:1,class:"arrow pagination__button",onClick:t[2]||(t[2]=(0,s.iM)(((...e)=>l.pagePlus&&l.pagePlus(...e)),["stop"])),type:"button"}," › ")):(0,o.kq)("",!0)],8,Ve)}var Qe={name:"PaginationHard",props:{proppages:{type:Number,required:!0,default:0},path:{type:String,required:!0,default:""}},data(){return{page:1,arrPage:["1","2","3","4","5","6","...","1000"],serverDate:[],target:1}},emits:{numPage:e=>"number"===typeof e&&e>0},methods:{setServ(){const e=[...Array(this.proppages+1).keys()].filter((e=>e>0));return this.serverDate=e},forcePage(e){this.page=e},setPage(e){this.target=e?.target;const t=+e?.target?.textContent;t&&(this.page=t,this.$emit("numPage",this.page))},pagePlus(){this.page++,this.$emit("numPage",this.page)},pageMinus(){this.page--,this.$emit("numPage",this.page)},setPagination(){this.arrPage=[...this.serverDate.slice(0,6),"...",this.serverDate.at(-1)]},mutateArr(){const e=[];return e.push(this.page+1,this.page+2,this.page-1,this.page-2,this.page),this.arrPage=[this.serverDate[0],"...",...e.sort(((e,t)=>e-t)),"...",this.serverDate.at(-1)]},noMutateArr(){return this.arrPage=[this.serverDate[0],...[...Array(7).keys()].filter((e=>e>1)),"...",`${this.serverDate.at(-1)}`]},maxArr(){this.arrPage=[this.serverDate[0],"...",...this.serverDate.slice(this.serverDate.length-5)]},lessPage(){this.arrPage=[...this.serverDate]},controlStorage(){return JSON.parse(window.localStorage.getItem("numberPage"))&&JSON.parse(window.localStorage.getItem("filmsPage"))&&"Home"===this.path?JSON.parse(window.localStorage.getItem("numberPage")):1}},watch:{page(){return+this.proppages<=6?this.lessPage():this.page>=6&&this.page<=this.serverDate.at(-5)?this.mutateArr():this.page<6?this.noMutateArr():this.page>=this.arrPage.at(-5)?this.maxArr():void 0}},async created(){if(this.page=this.controlStorage(),this.setServ(),+this.proppages<=6)return this.lessPage();this.setPagination()}};const Je=(0,U.Z)(Qe,[["render",qe],["__scopeId","data-v-5a17114f"]]);var je=Je,ze=a(3907),He=a(9483),Ge=a.n(He),Ke=a(2307),Ye=a.n(Ke);const Ze=(e,t)=>Ye()(e.map((e=>[e.id])),t.map((e=>[e.idFilm]))),Xe=new Re,et=(e,t)=>{const a=t.includes("watched")?"setWatched":"setQueue";Promise.all(e.map((e=>Xe.fetchMovieById(e.idFilm)))).then((e=>{st.commit(a,e),at.setItem(t,JSON.stringify(e))}))},tt=e=>{st.commit("setMaxPageForBiblioteka",{num:e.data.queueFilms[0]?.totalPage,type:"queue"}),st.commit("setMaxPageForBiblioteka",{num:e.data.watchedFilms[0]?.totalPage,type:"watched"})},at=Ge().createInstance({name:"myDatabase"}),st=(0,ze.MT)({state(){return{infoWatched:[],infoQueue:[],max:{numWatch:0,numQue:0}}},mutations:{setWatched(e,t){Array.isArray(t)?e.infoWatched=t:e.infoWatched.push(t)},setQueue(e,t){Array.isArray(t)?e.infoQueue=t:e.infoQueue.push(t)},delWatched(e,t){e.infoWatched=t},delQueue(e,t){e.infoQueue=t},setMaxPageForBiblioteka(e,{type:t,num:a}){t&&"watched"===t?e.max.numWatch=a??1:e.max.numQue=a??1}},getters:{doneWatcheds:e=>t=>e.infoWatched.some((e=>(e.id||e.idFilm)===t)),doneQueues:e=>t=>e.infoQueue.some((e=>(e.id||e.idFilm)===t))},actions:{async addFilmToWatched(e,t){await Ne.post("/films/add",{type:t.type,idFilm:t.idFilm},{headers:{Authorization:"Bearer "+t.token}})},async addFilmToQueue(e,t){await Ne.post("/films/add",{type:t.type,idFilm:t.idFilm},{headers:{Authorization:"Bearer "+t.token}})},async dellFilmFromDb(e,{type:t,idFilm:a,token:s}){if(await Ne["delete"](`/films/remove/${t}/${a}`,{headers:{Authorization:"Bearer "+s}}),"watched"===t){const t=e.state.infoWatched.filter((e=>e.id!==a));e.commit("delWatched",t),at.setItem("watched",JSON.stringify(t))}else{const t=e.state.infoQueue.filter((e=>e.id!==a));e.commit("delQueue",t),at.setItem("queue",JSON.stringify(t))}},async getFromServerFilmId({state:e},t){try{const a=await Ne.get("/films/",{headers:{Authorization:"Bearer "+t},params:{page:1,limit:20}});if(a){tt(a);const t=Ze(e.infoWatched,a.data.data.watchedFilms),s=Ze(e.infoQueue,a.data.data.queueFilms);!t&&et(a.data.data.watchedFilms,"watched"),!s&&et(a.data.data.queueFilms,"queue")}}catch(a){console.log(a)}}}});var ot=a(8703),it=a.n(ot);const nt=new Re;let rt=!1;var lt={name:"TrendMain",components:{ContainerMain:W,PaginationHardVue:je},props:{proppages:{type:Number,default:0},switcher:{type:Boolean,default:!1},modalstate:{type:Boolean,default:!1},path:{type:String,default:""}},emits:{"get-find-id":e=>"number"===typeof e},data(){return{trend:[],genrs:[],page:1,max:0,locate:0,check:!1}},beforeCreate(){!JSON.parse(window.localStorage.getItem("genres"))&&nt.getGenresList()},async created(){"Home"===this.path?this.startRenderPage():this.funcUpdateBibliotekaPage(),this.loaderBasic()},methods:{async startRenderPage(){const e=this.checkFind()?await nt.fetchMovieByQuery(window.localStorage.getItem("numberPage")??1,window.localStorage.getItem("findedFilms"),this.toMainPage):await nt.fetchTopMovies(this.page,this.toMainPage);0===e?.length&&this.toMainPage(),this.trend=this.controlStorage()||e,this.max=nt.maxPages;const t=JSON.parse(window.localStorage.getItem("genres"))??await nt.getGenresList();this.genrs=t},year(e){return e?e.slice(0,4):"no date"},getPoster(e){return`https://image.tmdb.org/t/p/w500/${e}`},getGenre(e){return e?.map((e=>this.criticalGenres.filter((({id:t,name:a})=>t===e&&a)))).flat(3).map((({name:e})=>e)).slice(0,2).join(", ")},async setPage(e){if(this.page=e,"Home"===this.path){window.localStorage.setItem("numberPage",e);const t=this.checkFind()?await nt.fetchMovieByQuery(this.page,window.localStorage.getItem("findedFilms")):await nt.fetchTopMovies(e);this.trend=t,this.max=nt.maxPages,window.localStorage.setItem("filmsPage",JSON.stringify(t))}else this.path.includes("Biblioteka")&&(await this.setPageBiblioteka(e),this.controlScroll());this.controlScroll()},async setPageBiblioteka(e){try{const t=await Ne.get("/films/",{headers:{Authorization:"Bearer "+this.$store.state.token},params:{page:e??this.page,limit:20}}),a=it()(st.state.infoWatched,t.data.watchedFilms.map((e=>e.idFilm)),((e,t)=>e.id===t)),s=it()(st.state.infoQueue,t.data.queueFilms.map((e=>e.idFilm)),((e,t)=>e.id===t));this.funcUpdateIfChangePath(a,s)}catch(t){console.log(t)}},controlStorage(){return!(!JSON.parse(window.localStorage.getItem("numberPage"))||!JSON.parse(window.localStorage.getItem("filmsPage")))&&JSON.parse(window.localStorage.getItem("filmsPage"))},controlScroll(){this.locate=window.scrollY,this.$nextTick().then((()=>{this.locate>100&&window.scrollBy(0,20*this.locate)}))},checkFind(){const e=!!JSON.parse(window.localStorage.getItem("findedFilms"));return this.check=e,e},toMainPage(){X.Report.info("Sorry","On your request we found nothing , we return you to the main.","Okay",(()=>{this.$router.go(0),window.localStorage.removeItem("numberPage"),window.localStorage.removeItem("findedFilms")}))},checkForStupid(){return this.trend.length>0},loaderBasic(){We.loader.interceptors.request.use((e=>(console.log(this.$store.state.token),e.params={language:"fi"},rt=e.url.includes("/3/movie/"),rt||this.checkForStupid()&&X.Block?.dots(".gallery__item",{svgColor:"var(--text-color-red)",svgSize:"100px",backgroundColor:"var(--bg-loader-basic)"}),e))),We.loader.interceptors.response.use((e=>(rt||this.checkForStupid()&&X.Block?.remove(".gallery__item"),e)))},getIdForModal(e){this.$emit("get-find-id",e)},funcUpdateIfChangePath(e,t){switch(this.path){case"BibliotekaWatched":this.trend=e??st.state.infoWatched.slice(0,20),this.max=st.state.max.numWatch;break;case"BibliotekaQueue":this.trend=t??st.state.infoQueue.slice(0,20),this.max=st.state.max.numQue;break;default:this.max=st.state.max.numWatch;break}},funcUpdateBibliotekaPage(){st.state.max["numWatch"]&&this.funcUpdateIfChangePath(),st.dispatch("getFromServerFilmId",this.$cookies.get("token")??this.$store.state.token).then((()=>{this.funcUpdateIfChangePath()}))},funcSubscribeForDelAction(){this.modalstate&&st.subscribe((e=>{const t=e.payload[0]?.id??!1;t&&!this.modalstate&&this.trend.splice(this.trend.findIndex((e=>e===t)),0)}))}},watch:{page(){this.$refs?.upBtn?.forcePage(this.page),this.page=this.$refs?.upBtn?.page,this.$refs?.downBtn?.forcePage(this.page),this.page=this.$refs?.downBtn?.page},switcher(){this.startRenderPage(),this.max=0},path(){this.page=1,this.funcUpdateBibliotekaPage()},modalstate(){this.funcSubscribeForDelAction()},trend(e){e.length<1&&this.funcUpdateBibliotekaPage()}},mounted(){this.loaderBasic()},updated(){console.log("test upd"),(!this.path||"Home"===this.path)&&this.startRenderPage(),1!==this.page||this.modalstate?this.setPageBiblioteka():this.funcUpdateBibliotekaPage()},computed:{criticalGenres(){return this.genrs.length?this.genrs:JSON.parse(window.localStorage.getItem("genres"))}}};const ct=(0,U.Z)(lt,[["render",Ce],["__scopeId","data-v-23952fa9"]]);var dt=ct;const ht=e=>((0,o.dD)("data-v-2a643b5f"),e=e(),(0,o.Cn)(),e),ut=l+"#icon-close",mt=["filmsid"],pt={class:"modalV container"},gt=ht((()=>(0,o._)("svg",{width:"30",height:"30",class:"icoV"},[(0,o._)("use",{href:ut})],-1))),ft=[gt],_t=["alt","src"],wt={class:"modal__titleV t-js"},vt={class:"flexboxV"},yt={class:"modal__listV"},kt={class:"modal__descV"},bt=ht((()=>(0,o._)("p",{class:"modal__pV"},"Vote / Votes",-1))),Pt={class:"modal__rV"},It={class:"reitV"},St={class:"countV"},Ft={class:"modal__descV"},Mt=ht((()=>(0,o._)("p",{class:"modal__pV"},"Popularity",-1))),At={class:"modal__valV t-js"},Ct={class:"modal__descV"},Et=ht((()=>(0,o._)("p",{class:"modal__pV"},"Original Title",-1))),$t={class:"modal__valV uperV t-js"},Dt={class:"modal__descV"},xt=ht((()=>(0,o._)("p",{class:"modal__pV"},"Genre",-1))),Ut={class:"modal__valV t-js"},Bt=ht((()=>(0,o._)("p",{class:"modal__aboutV t-js"},"About",-1))),Wt={class:"overview t-js"},Ot={class:"modal__button--listV"},Lt=["disabled"],Nt=["data-btn","disabled"];function Rt(e,t,n,r,l,c){return l.infos.title?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,i.C_)(["backdropV",{visibleV:l.openModal}]),filmsid:n.filmsid,tabindex:"-1",onClick:t[3]||(t[3]=(0,s.iM)(((...e)=>c.funcClickBackdrop&&c.funcClickBackdrop(...e)),["stop"]))},[(0,o._)("div",pt,[(0,o._)("button",{class:"closeV",type:"button",onClick:t[0]||(t[0]=(0,s.iM)(((...e)=>c.onClose&&c.onClose(...e)),["stop"]))},ft),(0,o._)("img",{alt:l.infos.title,src:l.infos.poster_path?`https://image.tmdb.org/t/p/w500/${l.infos.poster_path}`:a(6325)},null,8,_t),(0,o._)("div",null,[(0,o._)("h3",wt,(0,i.zw)(l.infos.title??"No date"),1),(0,o._)("div",vt,[(0,o._)("ul",yt,[(0,o._)("li",kt,[bt,(0,o._)("p",Pt,[(0,o._)("span",It,(0,i.zw)(l.infos.vote_average?.toFixed(1)),1),(0,o.Uk)(" / "),(0,o._)("span",St,(0,i.zw)(l.infos.vote_count),1)])]),(0,o._)("li",Ft,[Mt,(0,o._)("p",At,(0,i.zw)(l.infos.popularity?.toFixed(1)),1)]),(0,o._)("li",Ct,[Et,(0,o._)("p",$t,(0,i.zw)(l.infos.original_title),1)]),(0,o._)("li",Dt,[xt,(0,o._)("p",Ut,(0,i.zw)(l.infos.genres?.length>0?l.infos.genres.map((e=>e.name+", ")).join("").slice(0,-2):"No date"),1)])]),(0,o._)("div",null,[Bt,(0,o._)("p",Wt,(0,i.zw)(l.infos.overview||"No description will be added soon. Sorry for the inconvenience"),1)]),(0,o._)("ul",Ot,[(0,o._)("li",null,[(0,o._)("button",{onClick:t[1]||(t[1]=(0,s.iM)((()=>c.doneWatched?c.dellFilmFromDb("watched"):c.addFilmToWatch()),["prevent"])),"data-btn":"${id}",type:"button",class:(0,i.C_)(["modal__watchV",c.doneWatched&&"remove"]),disabled:!c.getAuth||l.checkParam&&l.loading},(0,i.zw)(c.doneWatched?"remove from watched":"add to Watched"),11,Lt)]),(0,o._)("li",null,[(0,o._)("button",{onClick:t[2]||(t[2]=(0,s.iM)((()=>c.doneQueue?c.dellFilmFromDb("queue"):c.addFilmToQueue()),["prevent"])),"data-btn":l.infos.id,type:"button",class:(0,i.C_)(["modal__queV",c.doneQueue&&"remove"]),disabled:!c.getAuth||!l.checkParam&&l.loading},(0,i.zw)(c.doneQueue?"remove from queue":"add to queue"),11,Nt)])])])])])],10,mt)):(0,o.kq)("",!0)}const Vt=new Re;var Tt={props:{filmsid:{type:Number,require:!0,default:-1},scrollWidth:{type:Number,require:!0,default:-1}},data(){return{openModal:!1,infos:[],checkParam:!1,loading:!1}},emits:{modalstate:e=>"boolean"===typeof e},created(){this.syncIndexDBandStore()},methods:{async getInfoOfFilms(){const e=await Vt.fetchMovieById(this.filmsid);this.infos=e},onClose(){this.openModal=!1,this.infos=[],this.$emit("modalstate",!1)},funcKeyDown(e){this.openModal&&"Escape"===e.code&&this.onClose()},funcClickBackdrop(e){e.target===e.currentTarget&&this.onClose()},async addFilmToWatch(){this.loaderBasic();try{await st.dispatch("addFilmToWatched",{type:"watched",idFilm:this.infos.id,token:this.$store.state.token}),st.commit("setWatched",this.infos),at.setItem("watched",JSON.stringify(st.state.infoWatched))}catch(e){console.log(e)}},async addFilmToQueue(){this.loaderBasic();try{await st.dispatch("addFilmToQueue",{type:"queue",idFilm:this.infos.id,token:this.$store.state.token}),st.commit("setQueue",this.infos),at.setItem("queue",JSON.stringify(st.state.infoQueue))}catch(e){console.log(e)}},async dellFilmFromDb(e){this.loaderBasic();try{await st.dispatch("dellFilmFromDb",{type:e,idFilm:this.infos.id,token:this.$store.state.token})}catch(t){console.log(t)}},syncIndexDBandStore(){at.keys().then((e=>{e.includes("watched")&&at.getItem("watched").then((e=>{st.commit("setWatched",JSON.parse(e))})),e.includes("queue")&&at.getItem("queue").then((e=>st.commit("setQueue",JSON.parse(e))))}))},syncServerDBandStore(){at.keys().then((e=>{e.includes("watched")||this.getFromServerFilmId().then((e=>{const t=e.data.allList.filter((e=>"watched"===e.type));st.commit("setWatched",t),at.setItem("watched",JSON.stringify(st.state.infoWatched))})),e.includes("queue")||this.getFromServerFilmId().then((e=>{const t=e.data.allList.filter((e=>"queue"===e.type));st.commit("setQueue",t),at.setItem("queue",JSON.stringify(st.state.infoQueue))}))}))},loaderBasic(){Ne.interceptors.request.use((e=>(this.loading=!0,this.checkParam=e.url.includes("add")&&e?.data?.type.includes("watched")||e.url.includes("watched"),e))),Ne.interceptors.response.use((e=>(this.loading=!1,e)))}},watch:{filmsid(){this.filmsid>=0&&(this.getInfoOfFilms(),this.openModal=!0,this.$emit("modalstate",this.openModal))},openModal(){window.addEventListener("keydown",this.funcKeyDown),!this.openModal&&window.removeEventListener("keydown",this.funcKeyDown)}},computed:{doneWatched(){return st.getters.doneWatcheds(this.infos.id)},doneQueue(){return st.getters.doneQueues(this.infos.id)},getAuth(){return this.$store.state.token}}};const qt=(0,U.Z)(Tt,[["render",Rt],["__scopeId","data-v-2a643b5f"]]);var Qt=qt,Jt=a(9831),jt={name:"App",components:{HeaderFilm:ae,FooterMain:fe,TrendMain:dt,ModalMain:Qt},props:{switcher:{type:Boolean,require:!0,default:!1}},data(){return{check:!1,filmsid:-1,locate:0,stateModal:!1,scrollWidth:0,path:"",show:!1,counterSign:0}},created(){window.addEventListener("focus",this.checkFocus),this.watchPath(),this.controlLogin()},methods:{async checkFocus(){if(this.$store.state.token){const e=window.atob(this.$store.state.token.split(".")[1]).includes("firebase");e?this.$store.dispatch("googleAuthInfo"):this.currentUser(this.$store.state.token)}else this.counterSign<=1&&(this.counterSign++,await this.refreshToken())},async controlLogin(){const e=(0,Jt.v0)();(0,Jt.Aj)(e,(e=>{e?e.getIdToken(!0).then((e=>{this.$store.commit("setLogin",e),this.refreshToken()})).catch((e=>console.log(e))):(this.currentUser(this.$store.state.token||this.$cookies.get("token")||void 0),!this.$cookies.get("token")&&this.refreshToken())}))},async refreshToken(){try{await this.$store.dispatch("refreshToken",this.$store.state.refresh),this.currentUser(this.$store.state.token||this.$cookies.get("token")||void 0),this.show=!0}catch(e){const t=(0,Jt.v0)();t.currentUser||(this.$store.commit("setLogin",""),window.localStorage.removeItem("name"),this.$cookies.remove("token"),this.$store.dispatch("googleAuthInfo")),console.log(e)}finally{this.show=!0}},async currentUser(e){try{await this.$store.dispatch("currentUser",e),st.dispatch("getFromServerFilmId",this.$store.state.token),this.$cookies.set("token",this.$store.state.token,"60MIN");const{exp:t}=JSON.parse(window?.atob(this.$store.state.token?.split(".")[1])),a=t-(Math.floor(new Date/1e3)+600);this.show=!0;const s=setTimeout((async()=>{await this.refreshToken(),clearTimeout(s)}),a>0?1e3*a:0)}catch(t){this.$cookies.remove("token"),this.$store.commit("setLogin",""),console.log(t)}finally{this.show=!0}},onChekfind(e){this.check=e},getFindId(e){this.stateModal||(this.filmsid=e,this.locate=window.scrollY,this.scrollCount())},scrollCount(){this.scrollWidth=window?.innerWidth-window?.document?.documentElement?.clientWidth,window.document.documentElement.style.setProperty("--left-modal",this.scrollWidth/2+"px")},modalstate(e){this.stateModal=e},watchPath(){this.$watch((()=>this.$route.name),(e=>{this.path=e.replace("/","")}))}},updated(){this.filmsid=-1},watch:{stateModal(){this.stateModal||(this.scrollWidth=0,this.$nextTick().then((()=>{window.scrollBy(0,this.locate)})))}},beforeUnmount(){window.removeEventListener("focus",this.checkFocus)}};const zt=(0,U.Z)(jt,[["render",r]]);var Ht=zt,Gt=a(6123),Kt=a.n(Gt);function Yt(e,t,a,s,i,n){return(0,o.wg)(),(0,o.iD)("div",null,"ftghuhjiojkopjk")}var Zt={};const Xt=(0,U.Z)(Zt,[["render",Yt]]);var ea=Xt,ta=a(2201);function aa(e,t,a,s,i,n){const r=(0,o.up)("TrendMain");return(0,o.wg)(),(0,o.j4)(r)}var sa={name:"BibliotekaPage",components:{TrendMain:dt},path:{type:String,default:""},data(){return{height:0,width:document.documentElement.clientWidth}}};const oa=(0,U.Z)(sa,[["render",aa]]);var ia=oa;const na={class:"limiter"},ra={class:"authBackground"};function la(e,t,a,s,i,n){const r=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",na,[(0,o._)("div",ra,[(0,o.Wm)(r)])])}var ca={name:"AuthPage"};const da=(0,U.Z)(ca,[["render",la],["__scopeId","data-v-1cfd3f12"]]);var ha=da;const ua=e=>((0,o.dD)("data-v-618e3a1a"),e=e(),(0,o.Cn)(),e),ma=l+"#icon-home",pa=l+"#icon-google",ga={class:"wrap-box"},fa=ua((()=>(0,o._)("span",{class:"login-form-title"}," Account Login ",-1))),_a={class:"wrap-input","data-validate":"Enter username"},wa=ua((()=>(0,o._)("span",{class:"focus-input","data-placeholder":""},null,-1))),va={class:"wrap-input","data-validate":"Enter password"},ya=ua((()=>(0,o._)("span",{class:"focus-input","data-placeholder":""},null,-1))),ka={class:"container-login-form-btn"},ba=["disabled"],Pa=ua((()=>(0,o._)("svg",{width:"46px",height:"46px"},[(0,o._)("use",{href:ma})],-1))),Ia=ua((()=>(0,o._)("svg",{class:"login__google--svg",width:"46px",height:"46px"},[(0,o._)("use",{href:pa})],-1))),Sa=[Ia];function Fa(e,t,a,n,r,l){const c=(0,o.up)("CustomInput"),d=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",ga,[fa,(0,o._)("form",{class:"login-form","data-form":"",onSubmit:t[2]||(t[2]=(0,s.iM)(((...e)=>l.funcSignInUser&&l.funcSignInUser(...e)),["prevent"]))},[(0,o._)("div",_a,[(0,o.Wm)(c,{find:r.mailLog,"onUpdate:find":t[0]||(t[0]=e=>r.mailLog=e),findModifiers:{trim:!0},class:"input",type:"email",name:"email",placeholder:"User email"},null,8,["find"]),wa]),(0,o._)("div",va,[(0,o.Wm)(c,{find:r.passLog,"onUpdate:find":t[1]||(t[1]=e=>r.passLog=e),findModifiers:{trim:!0},class:"input",type:"password",name:"passReg",placeholder:"Password"},null,8,["find"]),ya]),(0,o._)("div",ka,[(0,o._)("button",{class:(0,i.C_)(["login-form-btn",{disabled:l.noEmpty}]),disabled:l.noEmpty,type:"submit"}," Login ",10,ba),(0,o.Wm)(d,{to:{name:"AuthSignup"},class:"login-form-btn reg",type:"button"},{default:(0,o.w5)((()=>[(0,o.Uk)("Create account")])),_:1}),(0,o.Wm)(d,{to:{name:"Home"},class:"homeBtnLink"},{default:(0,o.w5)((()=>[Pa])),_:1})])],32),(0,o._)("button",{class:"login__google",onClick:t[3]||(t[3]=(0,s.iM)(((...e)=>l.googleLogin&&l.googleLogin(...e)),["prevent"]))},Sa)])}var Ma={data(){return{mailLog:"",passLog:""}},components:{CustomInput:V},created(){console.log(this.$store.state.user)},methods:{async funcSignInUser(){if(this.mailLog,this.passLog){X.Loading.dots();try{await this.$store.dispatch("signIn",{email:this.mailLog,password:this.passLog}),this.funcRedirectAfterLogin()}catch(e){return e.response?X.Report.failure(`Error ${e.response.data.code}`,e.response.data.message):X.Report.failure(`Error ${e.code}`,e.message)}finally{X.Loading.remove()}}},async googleLogin(){X.Loading.dots();try{await this.$store.dispatch("googleLogin"),this.funcRedirectAfterLogin(),console.log("trylogin")}catch(e){this.$router.push({path:"/auth/login"}),X.Notify.info("User stop auth")}finally{X.Loading.remove()}},funcRedirectAfterLogin(){this.$cookies.set("token",this.$store.state.token,"60MIN"),this.$router.push({path:"/",replace:!0}),st.dispatch("getFromServerFilmId",this.$store.state.token),X.Notify.success(`User ${window.localStorage.getItem("name")} created`)}},computed:{noEmpty(){return!(this.mailLog&&this.passLog&&this.passLog.length>=6)},authTest(){return this.$store.state.token}}};const Aa=(0,U.Z)(Ma,[["render",Fa],["__scopeId","data-v-618e3a1a"]]);var Ca=Aa;const Ea=e=>((0,o.dD)("data-v-7b886b62"),e=e(),(0,o.Cn)(),e),$a=l+"#icon-backbutton",Da=Ea((()=>(0,o._)("span",{class:"login-form-title"}," Registration ",-1))),xa={class:"wrap-input","data-validate":"Enter username"},Ua=Ea((()=>(0,o._)("span",{class:"focus-input","data-placeholder":""},null,-1))),Ba={class:"wrap-input","data-validate":"Enter email"},Wa=Ea((()=>(0,o._)("span",{class:"focus-input","data-placeholder":""},null,-1))),Oa={class:"wrap-input","data-validate":"Enter password"},La=Ea((()=>(0,o._)("span",{class:"focus-input","data-placeholder":""},null,-1))),Na={class:"container-login-form-btn"},Ra=["disabled"],Va=Ea((()=>(0,o._)("svg",{width:"46px",height:"46px",class:"formArrow"},[(0,o._)("use",{href:$a})],-1)));function Ta(e,t,a,n,r,l){const c=(0,o.up)("CustomInput"),d=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",null,[Da,(0,o._)("form",{onSubmit:t[3]||(t[3]=(0,s.iM)(((...e)=>l.funcSignUpUser&&l.funcSignUpUser(...e)),["prevent"])),class:"login-form","data-registr":""},[(0,o._)("div",xa,[(0,o.Wm)(c,{find:r.nameReg,"onUpdate:find":t[0]||(t[0]=e=>r.nameReg=e),findModifiers:{trim:!0},class:"input",type:"text",name:"username",placeholder:"User name"},null,8,["find"]),Ua]),(0,o._)("div",Ba,[(0,o.Wm)(c,{find:r.mailReg,"onUpdate:find":t[1]||(t[1]=e=>r.mailReg=e),findModifiers:{trim:!0},class:"input",type:"email",name:"email",placeholder:"User email"},null,8,["find"]),Wa]),(0,o._)("div",Oa,[(0,o.Wm)(c,{find:r.passReg,"onUpdate:find":t[2]||(t[2]=e=>r.passReg=e),findModifiers:{trim:!0},class:"input",type:"password",name:"passReg",placeholder:"Password"},null,8,["find"]),La]),(0,o._)("div",Na,[(0,o._)("button",{class:(0,i.C_)(["login-form-btn",{disabled:l.noEmpty}]),disabled:l.noEmpty,type:"submit"}," Registration ",10,Ra)]),(0,o.Wm)(d,{to:{name:"AuthLogin"},class:"form-btn-center",type:"button"},{default:(0,o.w5)((()=>[Va])),_:1})],32)])}var qa={components:{CustomInput:V},data(){return{nameReg:"",mailReg:"",passReg:""}},created(){console.log(this.$store.state.user)},methods:{async funcSignUpUser(){if(this.nameReg,this.mailReg,this.passReg){X.Loading.dots();try{await this.$store.dispatch("signUp",{name:this.nameReg,email:this.mailReg,password:this.passReg}),this.$router.push({path:"/auth/login"}),X.Notify.success(`User ${this.nameReg} created`)}catch(e){return e.response?X.Report.failure(`Error ${e.response.data.code}`,e.response.data.message):X.Report.failure(`Error ${e.code}`,e.message)}finally{X.Loading.remove()}}}},watch:{nameReg(){console.log(this.nameReg)}},computed:{noEmpty(){return!(this.nameReg&&this.mailReg&&this.passReg&&this.passReg.length>=6)}}};const Qa=(0,U.Z)(qa,[["render",Ta],["__scopeId","data-v-7b886b62"]]);var Ja=Qa;function ja(e,t,a,s,i,n){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.WI)(e.$slots,"default")])}var za={name:"HomePage",components:{}};const Ha=(0,U.Z)(za,[["render",ja]]);var Ga=Ha;const Ka=[{path:"/",name:"Home",component:Ga},{path:"/biblioteka",name:"Biblioteka",component:ia,children:[{path:"watched",name:"BibliotekaWatched",component:ea},{path:"queue",name:"BibliotekaQueue",component:ea}]},{path:"/auth",name:"Auth",component:ha,children:[{path:"login",name:"AuthLogin",component:Ca},{path:"signup",name:"AuthSignup",component:Ja}]},{path:"/:pathMatch(.*)*",name:"NotPage",component:ea}],Ya=(0,ta.p7)({history:(0,ta.PO)(),routes:Ka});var Za=Ya,Xa=a(3977);const{VUE_APP_API_KEY:es,VUE_APP_AUTH_DOMAIN:ts,VUE_APP_PROJECT_ID:as,VUE_APP_STORAGE_BUCKET:ss,VUE_APP_MESSAGING_SENDER_ID:os,VUE_APP_APP_ID:is}={NODE_ENV:"production",VUE_APP_API_KEY:"AIzaSyCYsVgBiD5Bug4EbXs8CwOEN95dfeXKcO4",VUE_APP_APP_ID:"1:210453152874:web:42c0624495b4605677b613",VUE_APP_AUTH_DOMAIN:"filmotekauth.firebaseapp.com",VUE_APP_FILMOTEKA:"https://filmotekabackend.cyclic.app/api",VUE_APP_MESSAGING_SENDER_ID:"210453152874",VUE_APP_PROJECT_ID:"filmotekauth",VUE_APP_STORAGE_BUCKET:"filmotekauth.appspot.com",BASE_URL:"/"},ns={apiKey:es,authDomain:ts,projectId:as,storageBucket:ss,messagingSenderId:os,appId:is};(0,Xa.ZF)(ns);const rs=new Jt.hJ,ls=((0,Jt.v0)(),(0,Jt.v0)()),cs=(0,ze.MT)({state(){return{token:"",user:null,refresh:""}},mutations:{setLogin(e,t){e.token=t},setUser(e,t){e.user=t},setRefresh(e,t){e.refresh=t}},actions:{async googleAuthInfo(e){try{const t=await Ne.get("user/auth/googleIP");window.localStorage.setItem("name",t.data.data.name),console.log("пішов вхід"),e.commit("setLogin",t.data.data.token),st.dispatch("getFromServerFilmId",t.data.data.token)}catch(t){const a=(0,Jt.v0)();e.token||(console.log("чи є вхід звичайним сбособом",!!e.token),await(0,Jt.w7)(a),console.log("бекенд не знайшов такого користувача"),e.commit("setLogin","")),console.log(t)}},async googleLogin(e){const t=await(0,Jt.rh)(ls,rs),a=t.user.accessToken;if(a){const{name:t,email:s}=JSON.parse(window.atob(a.split(".")[1]));window.localStorage.setItem("name",t),e.commit("setLogin",a),await Ne.post("user/auth/googleauth",{name:t,email:s,token:a,tokenRefresh:a+t[0]})}},async signUp(e,t){const a=await Ne.post("user/auth/signup",t);a&&e.commit("setUser",a.data.data.user)},async signIn(e,t){const a=await Ne.post("user/auth/login",t);if(a){const{name:t}=JSON.parse(window.atob(a.data.data.access_token.split(".")[1]));window.localStorage.setItem("name",t),e.commit("setLogin",a.data.data.access_token)}},async LogOut(e,t){if(ls.currentUser)return await Ne.get("user/auth/logout",{headers:{Authorization:"Bearer "+t}}),e.commit("setLogin",""),void await(0,Jt.w7)(ls);await Ne.get("user/auth/logout",{headers:{Authorization:"Bearer "+t}}),e.commit("setLogin","")},async currentUser(e,t){const a=await Ne.get("user/auth/current",{headers:{Authorization:"Bearer "+t}});a&&(window.localStorage.setItem("name",a.data.data.name),e.commit("setLogin",a.data.data.token),e.commit("setRefresh",a.data.data.tokenRefresh))},async refreshToken(e,t){const a=await Ne.post("user/auth/refresh","",{headers:{Authorization:"Bearer "+t}});if(a){const{name:t}=JSON.parse(window.atob(a.data.data.access_token.split(".")[1]));window.localStorage.setItem("name",t),e.commit("setLogin",a.data.data.access_token),e.commit("setRefresh",a.data.data.refresh_token)}}}}),ds=(0,s.ri)(Ht);ds.use(Za),ds.use(cs),ds.use(Kt()),ds.mount("#app")},6325:function(e,t,a){e.exports=a.p+"img/ded.01be9432.jpg"}},t={};function a(s){var o=t[s];if(void 0!==o)return o.exports;var i=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(i.exports,i,i.exports,a),i.loaded=!0,i.exports}a.m=e,function(){var e=[];a.O=function(t,s,o,i){if(!s){var n=1/0;for(d=0;d<e.length;d++){s=e[d][0],o=e[d][1],i=e[d][2];for(var r=!0,l=0;l<s.length;l++)(!1&i||n>=i)&&Object.keys(a.O).every((function(e){return a.O[e](s[l])}))?s.splice(l--,1):(r=!1,i<n&&(n=i));if(r){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[s,o,i]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){a.p="/"}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var o,i,n=s[0],r=s[1],l=s[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(o in r)a.o(r,o)&&(a.m[o]=r[o]);if(l)var d=l(a)}for(t&&t(s);c<n.length;c++)i=n[c],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(d)},s=self["webpackChunkfilmoteka"]=self["webpackChunkfilmoteka"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(9339)}));s=a.O(s)})();
//# sourceMappingURL=app.9cd3654d.js.map